<script type="text/javascript">

    LABKEY.Utils.requiresScript("snprc_ehr/utils.js", function () {});
    Ext4.onReady(function (){
        var webpart = <%=webpartContext%>;
        var ctx = EHR.Utils.getEHRContext(webpart.wrapperDivId, ['DefaultAnimalHistoryReport']);
        if(!ctx)
            return;

        Ext4.create('EHR.panel.AnimalHistoryPanel', {
            defaultReport: ctx.DefaultAnimalHistoryReport,
            defaultTab: 'General',
            showFilterOptionsTitle: true,
            showReportsOption:true,
            filterTypes: [{
                xtype: 'ldk-singlesubjectfiltertype',
                inputValue: LDK.panel.SingleSubjectFilterType.filterName,
                label: 'Single Animal',
                caseInsensitive: true,
                aliasTable: {
                    schemaName: 'study',
                    queryName: 'validIdAndAlias',
                    idColumn: 'Id',
                    aliasColumn: 'alias'
                }
            },{
                xtype: 'ehr-multianimalfiltertype',
                inputValue: EHR.panel.MultiAnimalFilterType.filterName,
                label: EHR.panel.MultiAnimalFilterType.label,
                caseInsensitive: true,
                searchOptions: {
                    room: false,
                    cage: false,
                    project: false,
                    protocol: true
                },
                aliasTable: {
                    schemaName: 'study',
                    queryName: 'validIdAndAlias',
                    colName: 'value',
                    idColumn: 'Id',
                    aliasColumn: 'alias'
                },
                multiSearchText: "IDs:<br><i>(Separated by commas, semicolons or line breaks)</i>"
            },{
                xtype: 'ehr-locationfiltertype',
                inputValue: EHR.panel.LocationFilterType.filterName,
                label: EHR.panel.LocationFilterType.label,
                searchOptions: {
                    area: true,
                    room: true,
                    cage: false
                }
            },{
                xtype: 'ldk-nofiltersfiltertype',
                inputValue: LDK.panel.NoFiltersFilterType.filterName,
                label: LDK.panel.NoFiltersFilterType.label
            }],
            renderTo: webpart.wrapperDivId
        });
    });

</script>
